### [Back_out_1dfilter_new.m](https://github.com/sg-s/da/blob/master/Back_out_1dfilter_new.m)
attempt to do the baccus-style filtering to get the two dimensional
### [BootStrapErrorBars.m](https://github.com/sg-s/da/blob/master/BootStrapErrorBars.m)

### [BootStrapErrorBars5.m](https://github.com/sg-s/da/blob/master/BootStrapErrorBars5.m)

### [CombineKontrollerData.m](https://github.com/sg-s/da/blob/master/CombineKontrollerData.m)
combines data from mulitple kontroller-generated data files (defaults to all .mats) and automatically and intelligently combines them
### [ComputeSmoothedStimulus.m](https://github.com/sg-s/da/blob/master/ComputeSmoothedStimulus.m)
part of the DA project
### [CrossCorrAnalysis.m](https://github.com/sg-s/da/blob/master/CrossCorrAnalysis.m)

### [DAModel.m](https://github.com/sg-s/da/blob/master/DAModel.m)
function [R,y,z] = DA_integrate2(S,p)
### [DAModel_bilobedKz.m](https://github.com/sg-s/da/blob/master/DAModel_bilobedKz.m)
modified to have a bilobed Kz filter. 
### [DAModelv2.m](https://github.com/sg-s/da/blob/master/DAModelv2.m)
function [R,y,z] = DA_integrate2(S,p)
### [DAModelv3.m](https://github.com/sg-s/da/blob/master/DAModelv3.m)
function [R,y,z] = DA_integrate2(S,p)
### [DAModelv4.m](https://github.com/sg-s/da/blob/master/DAModelv4.m)
function takes argument of stimulus and a parameter set and implements the DA
### [DASim.m](https://github.com/sg-s/da/blob/master/DASim.m)
simulates synthetic stimuli, using a exponentiated gaussian.
### [DA_Filters.m](https://github.com/sg-s/da/blob/master/DA_Filters.m)
plots the Ky and Kz filters from DA model parameters
### [DA_integrate2.m](https://github.com/sg-s/da/blob/master/DA_integrate2.m)
function [R,y,z] = DA_integrate2(S,p)
### [DA_integrate3.m](https://github.com/sg-s/da/blob/master/DA_integrate3.m)
function [R,y,z] = DA_integrate2(S,p,LNpred)
### [DGModelv1.m](https://github.com/sg-s/da/blob/master/DGModelv1.m)
see:
### [DeliverySystemModel.m](https://github.com/sg-s/da/blob/master/DeliverySystemModel.m)
this is a model of the odour delivery system
### [DeliverySystemModel_LN.m](https://github.com/sg-s/da/blob/master/DeliverySystemModel_LN.m)
this is a model of the odour delivery system
### [DivisiveGain.m](https://github.com/sg-s/da/blob/master/DivisiveGain.m)
this model divides a previous estimate of the response by a divisive gain term (like in the DA model)
### [DivisiveOrSubtractive.m](https://github.com/sg-s/da/blob/master/DivisiveOrSubtractive.m)

### [EffectOfCorrelationTime.m](https://github.com/sg-s/da/blob/master/EffectOfCorrelationTime.m)
Effect of Correlation Time on Linear Filters
### [EffectOfThreshold.m](https://github.com/sg-s/da/blob/master/EffectOfThreshold.m)
this is an interactive version of the gain analysis function, uses Manipulate.m
### [EffectOfThresholdEngine.m](https://github.com/sg-s/da/blob/master/EffectOfThresholdEngine.m)

### [EphaticCoupling.m](https://github.com/sg-s/da/blob/master/EphaticCoupling.m)

### [EstimateGain.m](https://github.com/sg-s/da/blob/master/EstimateGain.m)
estimates the gain of a system by comparing response to stimulus
### [EstimateGain2.m](https://github.com/sg-s/da/blob/master/EstimateGain2.m)
estimates the absolute gain for a dataset
### [ExplainingData.m](https://github.com/sg-s/da/blob/master/ExplainingData.m)
this m file attempts to fit models to all the data we present, and explain the observed phenemnology 
### [ExplainingFastGainControl.m](https://github.com/sg-s/da/blob/master/ExplainingFastGainControl.m)

### [FastFlicker.m](https://github.com/sg-s/da/blob/master/FastFlicker.m)

### [FilterBible.m](https://github.com/sg-s/da/blob/master/FilterBible.m)

### [Filter_Analysis.m](https://github.com/sg-s/da/blob/master/Filter_Analysis.m)
Filter Estimation
### [FindDAModelParameters.m](https://github.com/sg-s/da/blob/master/FindDAModelParameters.m)
finds the parameters for the DA model 
### [FindPeakResponseTimes.m](https://github.com/sg-s/da/blob/master/FindPeakResponseTimes.m)
finds the response times (in matrix indices of a given matrix x, after specifing when the stimulus nominally starts with t, also a matrix index)
### [FindResponseTimes.m](https://github.com/sg-s/da/blob/master/FindResponseTimes.m)
finds the response times (in matrix indices of a given matrix x, after specifing when the stimulus nominally starts with t, also a matrix index)
### [FitDAModelToData.m](https://github.com/sg-s/da/blob/master/FitDAModelToData.m)
fits the DA model to data
### [FitDAModelToData2.m](https://github.com/sg-s/da/blob/master/FitDAModelToData2.m)
fits the DA model to data
### [FitFD2DoseResponse.m](https://github.com/sg-s/da/blob/master/FitFD2DoseResponse.m)
fits a fractional derivative model to stimulus-response data
### [FitFilter.m](https://github.com/sg-s/da/blob/master/FitFilter.m)
the filter is modelled by a double gamma filter (two lobed)
### [FitFractionalDModel.m](https://github.com/sg-s/da/blob/master/FitFractionalDModel.m)
fits a fractional derivative model to stimulus-response data
### [FitLNModel.m](https://github.com/sg-s/da/blob/master/FitLNModel.m)
fits a Linear-Nonlinear Model to data
### [FitLinearModel2Data.m](https://github.com/sg-s/da/blob/master/FitLinearModel2Data.m)
accepts a filter, and a dataset, and finds the best scaling of the filter to match the data. 
### [FitNLModel.m](https://github.com/sg-s/da/blob/master/FitNLModel.m)
fits a Nonlinear-Linear Model to data
### [FitNLNModel.m](https://github.com/sg-s/da/blob/master/FitNLNModel.m)
fits a Nonlinear-Linear-Nonlinear Model to data
### [FitNModel.m](https://github.com/sg-s/da/blob/master/FitNModel.m)

### [FitNonLinearity.m](https://github.com/sg-s/da/blob/master/FitNonLinearity.m)
Fits a nonlinear function to two vectors X and Y
### [FitRAModel2Data.m](https://github.com/sg-s/da/blob/master/FitRAModel2Data.m)
fits the ReceptorAdaptationModel to data
### [FitXJWModel2Data.m](https://github.com/sg-s/da/blob/master/FitXJWModel2Data.m)
fits the Liu and Wang model (XJWNeuronWrapper) to ORN data. uses patternsearch and the optimisation toolbox. 
### [Fit_All_Data_NLN.m](https://github.com/sg-s/da/blob/master/Fit_All_Data_NLN.m)

### [FittingDAModel.m](https://github.com/sg-s/da/blob/master/FittingDAModel.m)
Fitting the Dynamical Adaptation Model to ORN Responses
### [Flickering_Stim_Background.m](https://github.com/sg-s/da/blob/master/Flickering_Stim_Background.m)

### [GainAnalysis4.m](https://github.com/sg-s/da/blob/master/GainAnalysis4.m)
a better, improved version of GainAnalysis.m
### [GainAnalysis5.m](https://github.com/sg-s/da/blob/master/GainAnalysis5.m)
a better, improved version of GainAnalysis4.m
### [GainAnalysisAllData.m](https://github.com/sg-s/da/blob/master/GainAnalysisAllData.m)

### [GainAnalysisExample.m](https://github.com/sg-s/da/blob/master/GainAnalysisExample.m)

### [GainAnalysisWrapper.m](https://github.com/sg-s/da/blob/master/GainAnalysisWrapper.m)
A wrapper for Gain Analysis
### [GainAnalysisWrapper2.m](https://github.com/sg-s/da/blob/master/GainAnalysisWrapper2.m)
A wrapper for Gain Analysis
### [GainPhasePlot.m](https://github.com/sg-s/da/blob/master/GainPhasePlot.m)

### [GeffenMeister.m](https://github.com/sg-s/da/blob/master/GeffenMeister.m)
performs a trial-wise analysis of model fits as done in Geffen and Meister 2009
### [GeffenMeisterSim.m](https://github.com/sg-s/da/blob/master/GeffenMeisterSim.m)

### [HowGeneralIsGainAdaptation.m](https://github.com/sg-s/da/blob/master/HowGeneralIsGainAdaptation.m)
summarises gain adaptation in all of carlotta's data. makes plots organised by receptor, odor, correlation length, etc. 
### [HowGeneralIsGainAdaptation_NLN.m](https://github.com/sg-s/da/blob/master/HowGeneralIsGainAdaptation_NLN.m)
summarises gain adaptation in all of carlotta's data. makes plots organised by receptor, odor, correlation length, etc. 
### [ImportMahmutData.m](https://github.com/sg-s/da/blob/master/ImportMahmutData.m)
specify where to load
i = 6;

### [InteractiveGainAnalysis.m](https://github.com/sg-s/da/blob/master/InteractiveGainAnalysis.m)
this is an interactive version of the gain analysis function, uses Manipulate.m
### [InteractiveGainAnalysisEngine.m](https://github.com/sg-s/da/blob/master/InteractiveGainAnalysisEngine.m)

### [KineticsAnalysis.m](https://github.com/sg-s/da/blob/master/KineticsAnalysis.m)
similar to Gain Analysis, performs a kinetics analysis on flickering stimulus data
### [LCM.m](https://github.com/sg-s/da/blob/master/LCM.m)
function [R,y,z] = LCM(S,p)
### [LFP_MSG.m](https://github.com/sg-s/da/blob/master/LFP_MSG.m)
LFP analysis of mean shifted gaussian odour inputs
### [LFP_analysis.m](https://github.com/sg-s/da/blob/master/LFP_analysis.m)

### [LNAModel.m](https://github.com/sg-s/da/blob/master/LNAModel.m)
the response filter is modelled by a double gamma filter (two lobed)
### [LargeVarianceFlickering.m](https://github.com/sg-s/da/blob/master/LargeVarianceFlickering.m)

### [LargeVarianceFlickering2.m](https://github.com/sg-s/da/blob/master/LargeVarianceFlickering2.m)

### [LiuWangReduced.m](https://github.com/sg-s/da/blob/master/LiuWangReduced.m)
a reduced version of the Liu-Wang model with 6 parameters:
### [MakeFig6G.m](https://github.com/sg-s/da/blob/master/MakeFig6G.m)
computes instantenous gain vs. preceding stimulus intensity, as in fig 6G in this paper:
### [MakeFig6H.m](https://github.com/sg-s/da/blob/master/MakeFig6H.m)
makes data for a plot as in fig 6H in this paper:
### [MakeFig6H_alt.m](https://github.com/sg-s/da/blob/master/MakeFig6H_alt.m)
an alternative version of Make Fig 6H, where we rely on peaks in the signal and response
### [MakeFig6H_trialwise.m](https://github.com/sg-s/da/blob/master/MakeFig6H_trialwise.m)
makes data for a plot as in fig 6H in this paper:
### [MakeGaussianFlicker.m](https://github.com/sg-s/da/blob/master/MakeGaussianFlicker.m)

### [MakeGaussianFlickerFromDistribution.m](https://github.com/sg-s/da/blob/master/MakeGaussianFlickerFromDistribution.m)
this m file looks around for mat files named "dist*.mat", loads them
### [MakeMeanShiftedGaussians.m](https://github.com/sg-s/da/blob/master/MakeMeanShiftedGaussians.m)
makes control paradigms for Kontroller
### [MakeNWRandomSignal.m](https://github.com/sg-s/da/blob/master/MakeNWRandomSignal.m)
this script makes a random binary signal according to what Nagel and Wilson said they did in their paper
### [MeanShiftedGaussians.m](https://github.com/sg-s/da/blob/master/MeanShiftedGaussians.m)

### [Mechanism3.m](https://github.com/sg-s/da/blob/master/Mechanism3.m)
in this document, we attempt to understand the mechanism behind gain adaptation
### [MechanismAnalysis_PlotGain.m](https://github.com/sg-s/da/blob/master/MechanismAnalysis_PlotGain.m)

### [MechanismAnalysis_PlotSummary.m](https://github.com/sg-s/da/blob/master/MechanismAnalysis_PlotSummary.m)

### [MechanismAnalysis_PrepData.m](https://github.com/sg-s/da/blob/master/MechanismAnalysis_PrepData.m)
this function prepares data from the experiments investigating the mechanism of adaptation
### [NagelWilsonModel.m](https://github.com/sg-s/da/blob/master/NagelWilsonModel.m)
specification of the Nagel-Wilson model for receptor binding, channel opening, and adptation via diffusable factor
### [NaturalFlickering.m](https://github.com/sg-s/da/blob/master/NaturalFlickering.m)
this is a complete rewrite on  4:06 , 10 February 2015. 
### [NaturalFlickering_ab2.m](https://github.com/sg-s/da/blob/master/NaturalFlickering_ab2.m)
this is a complete rewrite on  4:06 , 10 February 2015. 
### [ORNsAsFracDiff.m](https://github.com/sg-s/da/blob/master/ORNsAsFracDiff.m)
ORNs as fractional differentiators
### [OdorPulseLinearity.m](https://github.com/sg-s/da/blob/master/OdorPulseLinearity.m)
How the hell does odor delivery work? What does the PID
### [PairedPulseProtocol.m](https://github.com/sg-s/da/blob/master/PairedPulseProtocol.m)

### [PaperFigures.m](https://github.com/sg-s/da/blob/master/PaperFigures.m)
makes all the figures for the paper
### [PlotDataStatistics.m](https://github.com/sg-s/da/blob/master/PlotDataStatistics.m)
p = mean2(p);
	p = p(:);
end
p = p-min(p); p =p/max(p);
[y1,x1] = hist(p,50);
y1  = y1/max(y1);
if nargin == 3
	plot(plothere(1),x1,y1,'b');
	set(plothere(1),'box','on','YLim',[0 1.5]);
	title(plothere(1),'Stimulus and Response Dist.')
	legend(plothere(1),{'Stimulus','ORN'});
	xlabel(plothere(1),'Normalised Value')
	ylabel(plothere(1),'Normalised Density')
else
	plot(x1,y1,'b')
	set(gca,'box','on','YLim',[0 1.5])
	title('Stimulus and Response Dist.')
	legend Stimulus ORN
end



act = [];
stop_here = 100;
p = data(td).PID;
if ~isvector(p)
	### [PlotFilterDiagnostics.m](https://github.com/sg-s/da/blob/master/PlotFilterDiagnostics.m)
plots data from the diagnostics structure created by FitFitler2Data
### [PlotFilterDiagnostics2.m](https://github.com/sg-s/da/blob/master/PlotFilterDiagnostics2.m)
use a log axis
	set(gca,'YScale','log')
end
axis square

subplot(1,5,4), hold on
plot(diagnostics.reg,diagnostics.slope,'.','MarkerSize',marker_size2)
plot(diagnostics.reg(bf),diagnostics.slope(bf),'r.','MarkerSize',marker_size2)
set(gca,'LineWidth',2,'FontSize',20,'box','on','XScale','log')
xlabel('r','FontSize',font_size)
title('Gain','FontSize',font_size)
if max(diagnostics.slope)/min(diagnostics.slope) > 100
	### [PulsePeakAnalysis.m](https://github.com/sg-s/da/blob/master/PulsePeakAnalysis.m)
performs Pulse-peak-Analysis of gain for a flickering stimulus dataset.
### [ReceptorAdaptationModel.m](https://github.com/sg-s/da/blob/master/ReceptorAdaptationModel.m)
this is a model of ORN response where the ORN response f is given by
### [STA.m](https://github.com/sg-s/da/blob/master/STA.m)
computes the spike triggered averaged stimulus.
### [STA_Analysis.m](https://github.com/sg-s/da/blob/master/STA_Analysis.m)

### [SolveLNModel.m](https://github.com/sg-s/da/blob/master/SolveLNModel.m)
solves a Linear-Nonlinear model, i.e, a linear filter that operates on a static input non-linearity. 
### [SolveNLModel.m](https://github.com/sg-s/da/blob/master/SolveNLModel.m)
solves a Nonlinear-Linear model, i.e, a linear filter that operates on a static input non-linearity. 
### [SolveNLNModel.m](https://github.com/sg-s/da/blob/master/SolveNLNModel.m)
bi-lobed filter block

### [SolveNLNModel2.m](https://github.com/sg-s/da/blob/master/SolveNLNModel2.m)
reduced version of a NLN model, with 5 parameters defining the static non-linearities
### [SolveNWModel.m](https://github.com/sg-s/da/blob/master/SolveNWModel.m)
numerically integrates the Nagel-Wilson Model
### [SpikeAmplitudes.m](https://github.com/sg-s/da/blob/master/SpikeAmplitudes.m)

### [SpikeFreqAdaptation.m](https://github.com/sg-s/da/blob/master/SpikeFreqAdaptation.m)
Does Spike Frequency Adaptation imply Dynamical Adaptation? 
### [StepOnResponses.m](https://github.com/sg-s/da/blob/master/StepOnResponses.m)
Analyses the responses of ORNs to on-steps of odor
### [TheNWModel.m](https://github.com/sg-s/da/blob/master/TheNWModel.m)

### [UnderstandingFilters.m](https://github.com/sg-s/da/blob/master/UnderstandingFilters.m)

### [Understanding_Linear_Gain_Analysis.m](https://github.com/sg-s/da/blob/master/Understanding_Linear_Gain_Analysis.m)
load data
load('/local-data/DA-paper/data.mat')

### [ValidateDAParameters.m](https://github.com/sg-s/da/blob/master/ValidateDAParameters.m)
alpha in model
	p.B = x(2); ### [ValidateDAParameters2.m](https://github.com/sg-s/da/blob/master/ValidateDAParameters2.m)
alpha in model
p.B = x(2); ### [ValidateDAParameters3.m](https://github.com/sg-s/da/blob/master/ValidateDAParameters3.m)
alpha in model
p.B = x(2); ### [ValidateXJWParameters.m](https://github.com/sg-s/da/blob/master/ValidateXJWParameters.m)
calcium dynamics
p.Cm = x(1); ### [XJWNeuronEuler.m](https://github.com/sg-s/da/blob/master/XJWNeuronEuler.m)
part of the DA project
### [XJWNeuronWrapper.m](https://github.com/sg-s/da/blob/master/XJWNeuronWrapper.m)

### [XJW_cost_function.m](https://github.com/sg-s/da/blob/master/XJW_cost_function.m)
unpack data
stimulus = data.stimulus;
response = data.response;
time = data.time;

if nargin < 3
	IgnoreInitial = floor(length(data.stimulus)/20);
end

if nargin < 4
	RemoveMean = 0;
end


if isvector(stimulus)
	### [cd_2but.m](https://github.com/sg-s/da/blob/master/cd_2but.m)
wild assumptions
T = 11;
time = 1e-4:1e-4:T;
dt = 3e-3;
time2 = 0:3e-3:T;

### [consolidateData.m](https://github.com/sg-s/da/blob/master/consolidateData.m)
consolidate data accepts a path, and merges all the .mat files there into one consolidate blob
### [delivery_system.m](https://github.com/sg-s/da/blob/master/delivery_system.m)
part of the DA project
### [delivery_system2.m](https://github.com/sg-s/da/blob/master/delivery_system2.m)
part of the DA project
### [errorbar_cazzo.m](https://github.com/sg-s/da/blob/master/errorbar_cazzo.m)
  ERRORBAR(X,Y,L,U) plots the graph of vector X vs. vector Y with
### [fittingPowerLaws.m](https://github.com/sg-s/da/blob/master/fittingPowerLaws.m)
this document looks at how we can fit power laws to data, and the errors that arise from various ways of doing things.
### [fra.m](https://github.com/sg-s/da/blob/master/fra.m)

### [freqResp.m](https://github.com/sg-s/da/blob/master/freqResp.m)
computes the frequency response from raw, time series data
### [iff_ifb.m](https://github.com/sg-s/da/blob/master/iff_ifb.m)
part of the DA project
### [iga_data.m](https://github.com/sg-s/da/blob/master/iga_data.m)
remove trend in stimulus
temp = fit(IGA_data.time(:),IGA_data.stimulus(:),'poly2');
IGA_data.stimulus = IGA_data.stimulus - temp(IGA_data.time) + mean(IGA_data.stimulus);

### [pLNModel.m](https://github.com/sg-s/da/blob/master/pLNModel.m)
the filter is modelled by a double gamma filter (two lobed)
### [pLinearModel.m](https://github.com/sg-s/da/blob/master/pLinearModel.m)
the filter is modelled by a double gamma filter (two lobed)
### [what_controls_gain.m](https://github.com/sg-s/da/blob/master/what_controls_gain.m)

